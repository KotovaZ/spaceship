# Диаграмма сервисов
![image](https://i.ibb.co/Vvr9qFs/diagram.jpg)

## Описание сервисов

Выделяется следующий набор сервисов:
1. Auth service - Сервис аутентификации. Отвечает за аутентификацию пользователей и выдачу JWT.
2. Game server - игровой сервер. Отвечает за прием и обработку команд игроков, обрабатывает логику игры.
3. Game social service - социальный сервис. Регистрация турниров и участников, ведение статистики, система рейтингов.
4. Message broker - брокер сообщений. Организация очередей сообщений.
5. Notifier servie - сервис для отправки уведомлений.

### Сервис аутентификации
Релизует следующие методы:
- Регистрация игровой сессии с набором участников
- Аутентификация пользователя с выдачей JWT
- Получение открытого ключа

### Игровой сервер
Реализует следующие методы:
- Прием команд агента

### Социальный сервис
Реализует следующие методы:
- Регистрация пользователя
- Регистрация турнира
- Регистрация игры (в рамках турнира и без)
- Обработчик итога игровой сессии
- Просмотр статистики по различным отчетам

### Брокер сообщений
Принимает события на отправку уведомлений пользователю и делегирует их сервису уведомлений.

### Сервис уведомлений
Получает события на отправку уведомлений и отправляет уведомления игрокам

## Узкие места
1. Социальный сервис получился раздутым - при усложнении системы рейтингов и отчетов статистики его будет сложно поддерживать. Потенциальное решение: систему рейтингов и статистику можно вынести в отдельные сервисы.
2. Логика проверки JWT реализована в каждом сервисе отедльно. Решение: проверять достоверность подписи JWT на стороне API Gateway.

## Компоненты с высокой вероятностью изменения
1. Сервис уведомлений. Вероятно, бизнес захочет отправлять уведомления не только в агент, но и по другим каналам коммуникации. Решение: реализовать различные стратегии отправки уведомлений получателям. Стратегии при невозможности отправки по тому или иному каналу коммуникации можно будет менять "на лету".
2. Социальный сервис: система рейтингов и ачивки будут меняться регулярно по заданию маркетологов. Как уже было обозначено выше, желательно вынести этот функционал в отдельный микросервис. Также из социального сервиса необходимо убрать обработчик итогов игровых сервис, а передачу итогов игры вынести в отдельную очередь брокера сообщений - тогда получать события и обрабатывать их смогут люые сервисы, подписанные на очередь.